<html>
  <head>
    <title>Venus Surface and elevation</title>
    <style type="text/css">
      html{height:100%}body{margin:0;overflow:hidden;font:1.2em "Helvetica";color:#fff;height:100%}.donate{font:2em "Helvetica"};body *{width:100%;background:#0000;color:#fff}#viewerDiv{margin:auto auto;height:100%;padding:0}#menuDiv{z-index:1;position:absolute;top:0;margin-left:0}#header{position:fixed;right:0;top:0;height:30px;text-align:right}#header a:visited{color:white}#header a:link{color:grey}#footer{position:fixed;right:0;bottom:0;height:1.5em;text-align:center}#footer a:visited{color:white}#footer a:link{color:grey}.modal{display:none;position:fixed;z-index:1;padding-top:100px;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#000;background-color:rgba(0,0,0,0.9);top:50%;transform:translateY(-50%)}.modal-content{background-color:#fefefe;margin:auto;padding:20px;border:1px solid #888;border-radius:2rem;width:60%}.close{color:#aaa;float:right;text-align:right;font-size:2em;font-weight:bold}.close:hover,.close:focus{color:#000;text-decoration:none;cursor:pointer}.donate{margin:auto;border-radius:1rem;background:#00684d;background:-webkit-linear-gradient(top,transparent 0,rgba(0,0,0,0.4) 100%),-webkit-linear-gradient(left,#00b486 0,#00684d 50%,#00b486 100%);background:linear-gradient(to bottom,transparent 0,rgba(0,0,0,0.4) 100%),linear-gradient(to right,#00b486 0,#00684d 50%,#00b486 100%);background-position:0 0;background-size:200% 100%;color:#fff;padding:15px 65px 15px 15px;text-shadow:1px 1px 5px #666;-webkit-transition:all 800ms;transition:all 800ms}.atxt{display:inline-block;margin:20px;position:relative;text-decoration:none}.donate:after{border-left:1px solid #fff;color:#003527;content:"   ü§ç";font:1.2em;padding:.2em 0;padding-left:.1em;position:absolute;right:.1em;top:7px;-webkit-transition:all 600ms 200ms;transition:all 600ms 200ms}.donate:hover{background-position:-100% 0}.donate:hover:after{border-left:1px solid #008260;color:#fff;text-shadow:0 0 10px #000}.center{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}
    </style>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="js/dat.gui.min.js"></script>
    <script id="fragmentShader" type="x-shader/x-vertex"> 
      varying vec3 vNormal;
      void main() 
      {
      	float intensity = pow( 0.7 - dot( vNormal, vec3( 0.0, 0.0, 1.0 ) ), 4.0 ); 
      	gl_FragColor = vec4( 1.0, 1.0, 1.0, 1.0 ) * intensity;
      }
    </script>
  </head>
  <body>
    <div id="viewerDiv"></div>
    <div id="header">
      <a href="http://www.itowns-project.org/" target="_blank" style="color:white;">iTowns</a>
    </div>
    <div id="footer">¬© <a href="https://github.com/Lombard-Web-Services" alt="Lombard-Web-Services" target="_blank">LombardWeb</a>, <a href="http://www.ign.fr" target="_blank">IGN</a>, dataset : <a href="https://www.nasa.gov/feature/goddard/2021/parker-solar-probe-offers-a-stunning-view-of-venus" target="_blank">Parker Solar Probe, Magellan Team/JPL/USGS</a> model (<a href="http://www.cnes.fr" target="_blank">CNES</a>/<a href="http://grgs.obs-mip.fr/" target="_blank">GRGS</a> and <a href="http://www.gfz-potsdam.de/" target="_blank">GFZ</a>)</div>
    <script src="js/itowns2.js"> </script>
    <script type="text/javascript">
      var initCenter={longitude:2.3465,latitude:48.88,altitude:25000000};var viewerDiv=document.getElementById("viewerDiv");itowns.viewer.createSceneGlobe(initCenter,viewerDiv,{atmosphere:false,elevationZooms:[4,2]});itowns.viewer.addImageryLayer({protocol:"wmtsc",id:"GEOID",zoom:{min:1,max:4},customUrl:"venusterrain/jpg/%TILEMATRIX/localcolors2_%COL_%ROW.jpg",options:{mimetype:"image/jpg",tileMatrixSet:"WGS84G"},opacity:1});itowns.viewer.addElevationLayer({protocol:"wmtsc",id:"GEOID",zoom:{min:2,max:4},customUrl:"geoid/bil/%TILEMATRIX/geoid_%COL_%ROW.bil",noDataValue:-99999,zFactor:2000,options:{name:"ELEVATION.ELEVATIONGRIDCOVERAGE",mimetype:"image/x-bil;bits=32",tileMatrixSet:"WGS84G"}});itowns.viewer.update();var text={};var gui=new dat.GUI({autoPlace:false});gui.domElement.id="menuDiv";viewerDiv.appendChild(gui.domElement);var screenshot=function(){var f=itowns.viewer.scene.gfxEngine;var d=1232;var k=text.screenshot;var l={width:Math.ceil(k.width/d),height:Math.ceil(k.height/d)};var n=f.getRenderer().getSize();var a=document.createElement("canvas");var m=a.getContext("2d");a.width=k.width;a.height=k.height;console.log;for(var c=0;c<l.width;++c){for(var b=0;b<l.height;++b){console.log("screenshot, tile : ",(c+b*l.width)+"/"+(l.width*l.height));var h=c*d;var g=b*d;var e={width:Math.min(k.width-h,d),height:Math.min(k.height-g,d)};f.width=e.width;f.height=e.height;f.camera.resize(e.width,e.height);f.camera.camera3D.setViewOffset(k.width,k.height,h,g,e.width,e.height);f.scene.updateCamera();f.renderer.setSize(e.width,e.height);f.update();m.drawImage(f.renderer.domElement,h,g)}}a.toBlob(function(i){var o=document.createElement("a");var p=document.body.appendChild(o);o.style.display="none";var j=window.URL.createObjectURL(i);o.setAttribute("href",j);o.setAttribute("download","itowns-geoid.png");o.click();window.URL.revokeObjectURL(i);document.body.removeChild(p)});console.log("screenshot : done");f.width=n.width;f.height=n.height;f.camera.resize(n.width,n.height);f.camera.camera3D.clearViewOffset();f.scene.updateCamera();f.renderer.setSize(n.width,n.height);f.update()};var ss=gui.addFolder("Screenshot");text.screenshot={width:itowns.viewer.scene.gfxEngine.getRenderer().getSize().width,height:itowns.viewer.scene.gfxEngine.getRenderer().getSize().height,screenshot:screenshot};ss.add(text.screenshot,"screenshot");ss.add(text.screenshot,"width");ss.add(text.screenshot,"height");var onchangeZFactor=function(a){itowns.viewer.setZFactor("GEOID",a)};text.ZFactor=itowns.viewer.getZFactor("GEOID");gui.add(text,"ZFactor").min(1).max(20000).onChange(onchangeZFactor);var onchangeOpacity;text.Opacity=itowns.viewer.getLayerOpacity("GEOID");var controller=gui.add(text,"Opacity").listen().min(0).max(1);onchangeOpacity=function(a,b){return function(d){var c=Math.max(0,Math.min(d,1));text.Opacity=c;itowns.viewer.setLayerOpacity(b,c);a.updateDisplay()}}(controller,"GEOID");controller.onChange(onchangeOpacity);viewerDiv.addEventListener("globe-loaded",function(){console.log("Globe Loaded");gamepadloop()},false);window.addEventListener("gamepadconnected",function(a){console.log("Gamepad connected",a.gamepad)});window.addEventListener("gamepaddisconnected",function(a){console.log("Gamepad gamepaddisconnected",a.gamepad)});function gamepadloop(){window.requestAnimationFrame(gamepadloop);var j=navigator.getGamepads();var f=0.01;var a=0.05;var k=0.1;var h=0;for(var e=0;e<j.length;++e){var b=j[e];if(b){if(Math.abs(b.axes[0])>k){++h;itowns.viewer.scene.currentControls().rotateLeft(f*b.axes[0])}if(Math.abs(b.axes[1])>k){++h;itowns.viewer.scene.currentControls().rotateUp(f*b.axes[1])}var g=b.buttons[2].value-b.buttons[0].value;if(g>k){++h;itowns.viewer.scene.currentControls().dollyIn()}if(g<-k){++h;itowns.viewer.scene.currentControls().dollyOut()}var d=b.axes[3]+b.buttons[1].value-b.buttons[3].value;if(Math.abs(d)>k){onchangeOpacity(text.Opacity+a*d)}}}if(h){itowns.viewer.scene.currentControls().update()}};
         
    </script>
    <div id="myModal" class="modal">
      <div class="modal-content center">
        <span class="close">&times;</span>
        <p style="color:black;text-align:justify;margin-top:3em;">This script is distributed in opensource, it is modifiable, shareable for free without any feedback on the one who shared this content.</p>
        <p style="color:black;text-align:justify;">
          You can, if you wish, make a donation to enable the sustainability of lombardweb's opensource projects. Developing is a job that requires personal investment in terms of knowledge, time and resources. You can support the opensource sharing process by donating the amount you want. All contributions are welcome and will be respected on an equal basis.
        </p>
        <p style="color:black;text-align:left;">THANK YOU</p>
        <div style="text-align:center;margin:auto;top:2em;"><a href="https://paypal.me/LombardWeb" class="donate atxt" target="_blank">Donate</a></div>
      </div>
    </div>
    <script>
      var modal=document.getElementById("myModal");var span=document.getElementsByClassName("close")[0];document.onload=modal.style.display="block";span.onclick=function(){modal.style.display="none"};window.onclick=function(a){if(a.target==modal){modal.style.display="none"}};
    </script>
  </body>
</html>
